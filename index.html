<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carpet Aesthetic Product Photo Generator</title>
  <meta name="description" content="Ubah background foto produk jadi karpet aesthetic otomatis. Output HD." />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">üß∂</div>
      <div>
        <div class="title">Carpet Aesthetic Product Photo Generator</div>
        <div class="subtitle">Upload produk ‚Üí hapus background ‚Üí generate karpet aesthetic HD ‚Üí composite</div>
      </div>
    </div>
    <div class="top-actions">
      <button id="btnReset" class="btn ghost" type="button">Reset</button>
    </div>
  </header>

  <main class="layout">
    <!-- LEFT: controls -->
    <section class="panel">
      <div class="card">
        <h2>1) API & Input</h2>

        <label class="field">
          <span class="label">Gemini API Key</span>
          <input id="apiKey" type="password" placeholder="Paste API key kamu di sini" autocomplete="off" />
          <small class="hint">
            Disimpan di localStorage (di perangkatmu). Jangan share repo dengan key di dalam kode.
          </small>
        </label>

        <div class="row">
          <label class="field">
            <span class="label">Model image</span>
            <select id="model">
              <option value="gemini-3-pro-image-preview" selected>gemini-3-pro-image-preview (2K/4K opsional)</option>
              <option value="gemini-2.5-flash-image">gemini-2.5-flash-image (cepat, 1024px)</option>
            </select>
            <small class="hint">Jika butuh HD, pilih Gemini 3 Pro Image Preview.</small>
          </label>
        </div>

        <label class="field">
          <span class="label">Upload foto produk (JPG/PNG/WebP)</span>
          <input id="fileInput" type="file" accept="image/*" />
        </label>

        <div class="row2">
          <label class="check">
            <input id="keepShape" type="checkbox" checked />
            <span>Pertahankan bentuk produk 100% (no warp)</span>
          </label>

          <label class="check">
            <input id="watermark" type="checkbox" />
            <span>Watermark (OFF default)</span>
          </label>
        </div>

        <label class="field">
          <span class="label">Kekuatan stylize (0‚Äì100)</span>
          <input id="stylize" type="range" min="0" max="100" value="30" />
          <div class="mini" id="stylizeVal">30</div>
        </label>

        <div class="row">
          <label class="field">
            <span class="label">Rasio</span>
            <select id="ratio">
              <option value="1:1">1:1</option>
              <option value="4:5" selected>4:5</option>
              <option value="9:16">9:16</option>
              <option value="16:9">16:9</option>
            </select>
          </label>

          <label class="field">
            <span class="label">Resolusi output</span>
            <select id="res">
              <option value="1024">1024</option>
              <option value="1536" selected>1536 (HD)</option>
              <option value="2048">2048 (HD+)</option>
            </select>
          </label>
        </div>
      </div>

      <div class="card">
        <h2>2) Setting Karpet Aesthetic</h2>

        <div class="row">
          <label class="field">
            <span class="label">1. Warna karpet</span>
            <select id="carpetColor">
              <option value="cream" selected>cream</option>
              <option value="beige">beige</option>
              <option value="ivory">ivory</option>
              <option value="latte">latte</option>
              <option value="light grey">light grey</option>
              <option value="charcoal">charcoal</option>
              <option value="pastel pink">pastel pink</option>
              <option value="sage">sage</option>
              <option value="sky blue">sky blue</option>
              <option value="terracotta">terracotta</option>
              <option value="custom">Custom</option>
            </select>
          </label>

          <label class="field">
            <span class="label">Custom warna (hex)</span>
            <input id="carpetColorHex" placeholder="#F3E7D0" disabled />
          </label>
        </div>

        <label class="field">
          <span class="label">2. Karpet bulu atau halus?</span>
          <select id="carpetType">
            <option value="thick fluffy carpet">bulu tebal</option>
            <option value="short pile fluffy carpet" selected>bulu pendek</option>
            <option value="smooth velvet carpet">halus (velvet)</option>
            <option value="woven carpet">woven (anyaman)</option>
            <option value="light shaggy carpet">shaggy ringan</option>
          </select>
        </label>

        <label class="field">
          <span class="label">3. Ornamen</span>
          <div class="chips" id="ornamentChips"></div>
          <div class="row">
            <select id="ornamentPick"></select>
            <button id="ornamentAdd" class="btn small" type="button">Tambah</button>
          </div>
          <div class="row">
            <input id="ornamentCustom" placeholder="Custom ornamen (misal: 'buku tulis minimal dan laptop tipis')" />
            <button id="ornamentAddCustom" class="btn small" type="button">Tambah custom</button>
          </div>
          <small class="hint">Jika pilih ‚Äútanpa ornamen‚Äù, ornamen lain akan dinonaktifkan.</small>
        </label>

        <label class="field">
          <span class="label">4. Suasana</span>
          <select id="mood">
            <option value="clean studio" selected>clean studio</option>
            <option value="cozy home">cozy home</option>
            <option value="minimal modern">minimal modern</option>
            <option value="korean aesthetic">korean aesthetic</option>
            <option value="luxury calm">luxury calm</option>
            <option value="warm morning">warm morning</option>
            <option value="moody night">moody night</option>
            <option value="festive soft">festive soft</option>
          </select>
        </label>

        <label class="field">
          <span class="label">5. Cahaya</span>
          <select id="light">
            <option value="window soft daylight" selected>window soft daylight</option>
            <option value="golden hour warm">golden hour warm</option>
            <option value="diffused studio softbox">diffused studio softbox</option>
            <option value="moody side light">moody side light</option>
            <option value="night warm lamp">night warm lamp</option>
            <option value="cool daylight">cool daylight</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Intensity cahaya (0‚Äì100)</span>
          <input id="lightIntensity" type="range" min="0" max="100" value="60" />
          <div class="mini" id="lightIntensityVal">60</div>
        </label>

        <label class="field">
          <span class="label">6. Posisi kamera</span>
          <select id="cameraPos">
            <option value="top-down 90 degrees, straight overhead, flat lay" selected>top view 90¬∞</option>
            <option value="45 degree angle, slightly elevated">45¬∞ angle</option>
            <option value="eye-level product shot">eye-level</option>
            <option value="close-up detail shot">close-up detail</option>
            <option value="macro detail shot">macro detail</option>
            <option value="flat lay composition">flat lay</option>
          </select>
        </label>

        <label class="field">
          <span class="label">7. Hasil foto kamera</span>
          <select id="cameraType">
            <option value="iPhone 15 Pro" selected>iPhone 15 Pro</option>
            <option value="iPhone 14">iPhone 14</option>
            <option value="Samsung S24 Ultra">Samsung S24 Ultra</option>
            <option value="Sony A7IV with 50mm lens">Sony A7IV 50mm</option>
            <option value="Canon R6 with 35mm lens">Canon R6 35mm</option>
            <option value="Fujifilm XT5">Fujifilm XT5</option>
            <option value="DSLR product studio camera">DSLR product studio</option>
            <option value="custom">Custom</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Custom kamera (opsional)</span>
          <input id="cameraCustom" placeholder="contoh: 'Sony A7C II 35mm'" disabled />
        </label>
      </div>

      <div class="card">
        <h2>3) Preset Cepat</h2>
        <div class="preset-grid">
          <button class="btn preset" data-preset="p1" type="button">
            Cream Shaggy + Plant + Window Light + Top View + iPhone 15 Pro
          </button>
          <button class="btn preset" data-preset="p2" type="button">
            Beige Smooth + Magazine + Golden Hour + 45¬∞ + Sony A7IV
          </button>
          <button class="btn preset" data-preset="p3" type="button">
            Grey Woven + No Ornament + Softbox + Top View + Canon R6
          </button>
        </div>

        <div class="actions">
          <button id="btnAutoRemove" class="btn" type="button">Auto Remove BG</button>
          <button id="btnMaskMode" class="btn ghost" type="button">Manual Mask (Brush)</button>
          <button id="btnGenerate" class="btn primary" type="button">Generate (2 Variants)</button>
          <button id="btnRegen" class="btn" type="button" disabled>Regenerate</button>
        </div>

        <div class="status" id="status">
          <div class="dot"></div>
          <div class="text">Siap.</div>
        </div>

        <div class="progress hide" id="progressWrap">
          <div class="shimmer"></div>
          <div class="ptext" id="progressText">Loading...</div>
        </div>

        <details class="note">
          <summary>Catatan penting</summary>
          <ul>
            <li>Auto background removal via library browser bisa berat; jika gagal, pakai Manual Mask.</li>
            <li>Output image model memiliki watermark SynthID dari Google (bawaan model). Ó®Å2Ó®Ç</li>
            <li>Untuk performa terbaik background removal butuh header COOP/COEP (GitHub Pages biasanya tidak). Ó®Å3Ó®Ç</li>
          </ul>
        </details>
      </div>
    </section>

    <!-- RIGHT: preview -->
    <section class="preview">
      <div class="card">
        <h2>Preview & Output</h2>

        <div class="preview-grid">
          <div class="slot">
            <div class="slot-title">Input / Cutout</div>
            <canvas id="canvasCutout" width="640" height="640"></canvas>
            <div class="slot-actions">
              <button id="btnDownloadCutout" class="btn small" type="button" disabled>Download Cutout (PNG)</button>
            </div>
          </div>

          <div class="slot">
            <div class="slot-title">Variant A</div>
            <canvas id="canvasA" width="640" height="640"></canvas>
            <div class="slot-actions">
              <button id="btnDownloadA" class="btn small" type="button" disabled>Download A</button>
            </div>
          </div>

          <div class="slot">
            <div class="slot-title">Variant B</div>
            <canvas id="canvasB" width="640" height="640"></canvas>
            <div class="slot-actions">
              <button id="btnDownloadB" class="btn small" type="button" disabled>Download B</button>
            </div>
          </div>
        </div>

        <div class="mask-ui hide" id="maskUI">
          <h3>Manual Mask (Brush)</h3>
          <p class="hint">
            Cat foreground produk dengan brush putih. Background tetap hitam. Klik ‚ÄúApply Mask‚Äù untuk bikin cutout.
          </p>
          <div class="mask-tools">
            <label class="field">
              <span class="label">Brush size</span>
              <input id="brushSize" type="range" min="5" max="80" value="24" />
              <div class="mini" id="brushSizeVal">24</div>
            </label>
            <div class="row2">
              <button id="btnMaskApply" class="btn primary" type="button">Apply Mask</button>
              <button id="btnMaskClear" class="btn ghost" type="button">Clear</button>
              <button id="btnMaskClose" class="btn ghost" type="button">Close</button>
            </div>
          </div>
          <canvas id="canvasMask" width="640" height="640"></canvas>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div>Made for: Product photo background ‚Üí carpet aesthetic (HD)</div>
  </footer>

  <script type="module" src="./app.js"></script>
</body>
  </html>
